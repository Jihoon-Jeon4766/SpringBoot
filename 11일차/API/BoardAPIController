package com.example.project.api;

import com.example.project.dto.BoardForm;
import com.example.project.entity.Board;
import com.example.project.repository.BoardRepository;
import lombok.extern.slf4j.Slf4j;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.*;

import java.util.List;

@Slf4j
@RestController
public class BoardAPIController {

    //의존성 주입
    @Autowired
    private BoardRepository boardRepository;

    // GET
    @GetMapping("/api/boards")
    public List<Board> readBoard(){
        return boardRepository.findAll(); // JSON 데이터 반환..
    }

    @GetMapping("/api/boards/{id}")
    public Board readBoard(@PathVariable Long id){

        return boardRepository.findById(id).orElse(null);

    }

    //게시글 생성
    @PostMapping("/api/boards/create")
    public Board createBoard(@RequestBody BoardForm form){
        Board board = form.toEntity();
        return boardRepository.save(board);
    }

    @PatchMapping("/api/boards/{id}/edit")
    public Board editBoard(@RequestBody BoardForm form, @PathVariable Long id){
        Board board = form.toEntity();

        return boardRepository.findById(id).orElse(null);
    }
}
